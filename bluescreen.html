<!DOCTYPE html>
<html lang="en" style="height: 100%;">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">

    <meta name="description" content="Windows 12 Web Version - An open-source project showcasing a playful web-based preview.">

    <title>Windows 12 Web Version</title>

    <style>
        * {
            user-select: none;
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            height: 100%;
            background: #005eaa;
            display: flex;
            justify-content: center;
            align-items: center;
            font-family: Arial, sans-serif;
        }

        #box {
            width: 70%;
            text-align: left;
            color: #fff;
        }

        /* Face */
        #happy-face {
            font-size: 150px;
            display: flex;
            position: relative;
            height: 150px;
            margin-bottom: 30px;
        }
        #happy-face p {
            line-height: 0;
            position: relative;
        }

        @keyframes eyeA {
            0%, 25%, 50%, 85% { top: -140px; left: -40px; }
            15% { top: -150px; left: -60px; }
            35% { top: -150px; left: -20px; }
            95% { top: -50px; left: -40px; }
        }

        @keyframes eyeB {
            0%, 25%, 50%, 90% { top: -140px; left: 14px; }
            15% { top: -150px; left: -6px; }
            35% { top: -150px; left: 34px; }
        }

        @keyframes mouthAnim {
            0% { transform: rotate(90deg); top: 10px; left: -60px; }
            15% { transform: rotate(120deg); top: -10px; left: -80px; }
            25% { transform: rotate(90deg); top: 10px; left: -60px; }
            35% { transform: rotate(60deg); top: -10px; left: -20px; }
            50% { transform: rotate(270deg); top: 10px; left: -80px; }
            80% { transform: rotate(270deg); top: -10px; left: -80px; }
            90% { transform: rotate(180deg); top: -25px; left: -60px; }
        }

        .eye.a { animation: eyeA 2s; top: -50px; left: -40px; }
        .eye.b { animation: eyeB 2s; top: -120px; left: -75px; }
        .mouth { animation: mouthAnim 2s; transform: rotate(180deg); top: -25px; left: -60px; }

        #progress-text {
            font-size: 23px;
            margin-bottom: 15px;
        }

        #details {
            display: flex;
            margin-top: 10px;
        }

        #details a {
            color: #efefef;
            text-decoration: none;
            transition: 0.2s;
        }

        #details a:hover {
            color: #bbb;
        }

        #qr {
            width: 150px;
            height: 150px;
            margin-right: 20px;
            background: #fff;
        }

        #stopcode { user-select: text !important; }
    </style>
</head>

<body>
    <div id="box">
        <div id="happy-face">
            <p class="eye a">.</p>
            <p class="eye b">.</p>
            <p class="mouth">)</p>
        </div>

        <p style="font-size: 23px;">
            Your device ran into a problem and needs to restart.<br>
            Weâ€™re just pretending to collect some error info, and then your screen will reboot.
        </p>

        <p id="progress-text"><span id="complete">0</span>% complete</p>

        <div id="details">
            <svg id="qr" xmlns="http://www.w3.org/2000/svg" viewBox="20 15 305 305"></svg>

            <p>
                For more information about this issue and possible fixes, visit:<br>
                <a href="https://www.windows.com/stopcode" target="_blank">https://www.windows.com/stopcode</a><br><br>
                If you call support, give them this info:<br>
                Stop Code: <span id="stopcode">YOU_MAY_DID_NOT_STAR_THIS_PROJECT</span>
            </p>
        </div>
    </div>

    <script src="scripts/jq.min.js"></script>
    <script>
        let complete = document.getElementById("complete");

        function increment() {
            let value = parseInt(complete.innerText);

            if (value >= 100) {
            document.documentElement.style.filter = "brightness(0)";
            setTimeout(() => {
                window.location.href = "index.html";  // redirect instead of reload
            }, 2000);
            return;
        }

            let delay =
                value < 20 ? 300 :
                value < 60 ? 200 :
                value < 80 ? 100 :
                50;

            setTimeout(() => {
                complete.innerText = value + 1;
                increment();
            }, delay);
        }

        increment();

        const params = new URLSearchParams(window.location.search);
        const code = params.get("code");
        if (code) document.getElementById("stopcode").innerText = code;
    </script>
</body>
</html>
